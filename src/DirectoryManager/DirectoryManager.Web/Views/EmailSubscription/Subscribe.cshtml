@model DirectoryManager.Web.Models.Emails.EmailSubscribeModel
@using DirectoryManager.Web.Constants;

@{
    ViewData[StringConstants.TitleHeader] = "Join Email Newsletter";
    Layout = "_CenteredLayout";
}

@section PageContent {
    <h1>@ViewData[StringConstants.TitleHeader]</h1>

    <hr />

    @if (this.ViewBag.NewsletterSummaryHtml != null)
    {
        @Html.Raw(this.ViewBag.NewsletterSummaryHtml)
    }

    <!-- Validation summary (server-side errors show here) -->
    <div class="text-danger">
        @Html.ValidationSummary(excludePropertyErrors: false)
    </div>

    <form asp-controller="EmailSubscription" asp-action="Subscribe" method="post" class="form-inline">
        @Html.AntiForgeryToken()

        <p>Email:</p>
        <input name="Email"
               type="email"
               id="inlineFormInput"
               placeholder="yourname@email.com"
               value="@(Model?.Email ?? string.Empty)" />
        <div class="text-danger" style="margin-top:4px;">
            @Html.ValidationMessage("Email")
        </div>

        <br />
        <br />

        <div>
            <!-- Shared, no-JS CAPTCHA block (context = "newsletter") -->
            @await Html.PartialAsync("_CaptchaBlock", "newsletter")
            <div class="text-danger" style="margin-top:4px;">
                @Html.ValidationMessage("Captcha")
            </div>
        </div>

        <br />
        <button type="submit" class="btn btn-success">Subscribe</button>
    </form>
}
